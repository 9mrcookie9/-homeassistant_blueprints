blueprint:
  name: Climate Control Based on Window State with Invert Option
  description: Switch off climate when a window is open (or closed, if inverted) and turn it back to auto when the state changes.
  domain: automation
  input:
    climate_entity:
      name: Climate Entity
      description: The climate device to control
      selector:
        entity:
          domain: climate
    window_sensor:
      name: Window Sensor
      description: The binary sensor to monitor window state
      selector:
        entity:
          domain: binary_sensor
    invert:
      name: Invert Logic
      description: Input from binary sensor is inverted.
      default: false
      selector:
        boolean:

trigger:
  - platform: state
    entity_id: !input window_sensor

action:
  - choose:
      # Inverted logic
      - conditions:
          - condition: template
            value_template: >
              {{ (is_state(input.window_sensor, 'on') and not input.invert) or 
                 (is_state(input.window_sensor, 'off') and input.invert) }}
        sequence:
          - service: climate.turn_off
            target:
              entity_id: !input climate_entity
      # Normal logic
      - conditions:
          - condition: template
            value_template: >
              {{ (is_state(input.window_sensor, 'off') and not input.invert) or 
                 (is_state(input.window_sensor, 'on') and input.invert) }}
        sequence:
          - service: climate.set_hvac_mode
            target:
              entity_id: !input climate_entity
            data:
              hvac_mode: auto
